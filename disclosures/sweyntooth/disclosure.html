<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title> Unleashing Mayhem over Bluetooth Low
Energy</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- html,xhtml --> 
<meta name="src" content="disclosure.tex" /> 
<link rel="stylesheet" type="text/css" href="disclosure.css" /> 

<link rel="stylesheet" href="scale.css">
</head>
<body>
<link href="" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet" type="text/css">
<link href="https://cdn.jsdelivr.net/npm/@mdi/font@^3.0.0/css/materialdesignicons.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/quasar@^1.4.5/dist/quasar.min.css">
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script src="https://cdn.jsdelivr.net/npm/quasar@^1.4.5/dist/quasar.umd.min.js"></script>

<div id="q-app">
    <div class="row items-start justify-center q-pa-md">
        <q-btn-group push style="margin-top: 10px;margin-bottom: -5px">
            <q-btn outline label="White Paper" icon-right="insert_drive_file" color="secondary"
                   @click="window.open('/disclosures/sweintooth/sweyntooth.pdf');"></q-btn>
            <q-btn outline label="Overview" icon-right="visibility" color="secondary"
                   @click="document.getElementById('overview').scrollIntoView();"></q-btn>
            <q-btn outline label="Affected Devices" icon-right="scatter_plot" color="secondary"
                   @click="document.getElementById('affected-devices').scrollIntoView();"></q-btn>
        </q-btn-group>
        <q-btn-group push style="margin-top: 10px;margin-bottom: -20px">
            <q-btn outline label="Patches" icon-right="security" color="secondary"
                   @click="document.getElementById('patches').scrollIntoView();"></q-btn>
            <q-btn outline label="Technical Description" icon-right="help_outline" color="secondary"
                   @click="document.getElementById('technical-description').scrollIntoView();"></q-btn>
            <q-btn outline label="Proof of Concept" color="secondary"
                   @click="window.open('https://github.com/Matheus-Garbelini/sweyntooth_bluetooth_low_energy_attacks');">
                   <img src="sweyntooth_icon.svg" style="width:15px; margin-left:8px"></img>
                   </q-btn>
        </q-btn-group>
    </div 


>
  <div class="maketitle">
                                                
                                                                                                
                                                                                                

<h2 class="titleHead" style="font-size: 2.5rem;"> Unleashing Mayhem over Bluetooth Low Energy</h2>
 <div class="author" > <span 
class="ptmr8t-x-x-120">Matheus E. Garbelini</span><sup><span 
class="zptmcmr-x-x-90">1</span></sup><span 
class="ptmr8t-x-x-120">; Sudipta Chattopadhyay</span><sup><span 
class="zptmcmr-x-x-90">1</span></sup><span 
class="ptmr8t-x-x-120">; Chundong Wang</span><sup><span 
class="zptmcmr-x-x-90">1</span></sup>
<br />          <sup><span 
class="zptmcmr-x-x-90">1</span></sup><span 
class="ptmri8t-x-x-120">Singapore University of Technology and Design</span><br /></div><br />
  </div>
  <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">1    </span> <a 
 id="x1-10001"></a><a id="overview">Introducing </a><span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span></span></h3>
<!--l. 58--><p class="noindent" >The Bluetooth Low Energy (BLE) is a wireless communication
technology specially designed to prolong battery life of devices
with different power consumption and usage capabilities. BLE
consists of a set of many standardised protocols that provide
remote connectivity and security between a simple device
(peripheral) and the user&#8217;s device (central) which is usually a
smartphone or a notebook. The relevant interaction between both
devices is presented in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-1001r1">1<!--tex4ht:ref: fig:blesequence --></a>.
</p><!--l. 65--><p class="indent" >  <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>captures a family of <span id="textcolor1"><span 
class="ptmb8t-">12 vulnerabilities</span></span>
(more under non-disclosure) across different BLE software
development kits (SDKs) of six major system-on-a-chip (SoC)
vendors. The vulnerabilities expose flaws in specific BLE SoC
implementations that allow an attacker in radio range to trigger
<span id="textcolor2"><span 
class="ptmb8t-">deadlocks, crashes</span></span> and <span id="textcolor3"><span 
class="ptmb8t-">buffer overflows</span></span> or <span id="textcolor4"><span 
class="ptmb8t-">completely bypass</span>
<span 
class="ptmb8t-">security</span></span> depending on the circumstances.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-1001r1"></a>
                                                
                                                                                                
                                                                                                
<!--l. 77--><p class="noindent" > <img 
src="Figures/ble_sequence.pdf.svg" alt="PIC"  
width="360" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">BLE messages exchange diagram</span></div><!--tex4ht:label?: x1-1001r1 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 83--><p class="indent" >  <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>potentially affects IoT products in appliances
such as smart-homes, wearables and environmental tracking or
sensing. We have also identified several medical and logistics
products that could be affected.
</p><!--l. 87--><p class="indent" >  As of today, <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>vulnerabilities are found in
the BLE SDKs sold by major SoC vendors, such as <span 
class="ptmb8t-">Texas</span>
<span 
class="ptmb8t-">Instruments</span>, <span 
class="ptmb8t-">NXP</span>, <span 
class="ptmb8t-">Cypress</span>, <span 
class="ptmb8t-">Dialog Semiconductors</span>,
<span 
class="ptmb8t-">Microchip</span>, <span 
class="ptmb8t-">STMicroelectronics </span>and <span 
class="ptmb8t-">Telink Semiconductor</span>. <span 
class="ptmri8t-">By</span>
<span 
class="ptmri8t-">no means, this list of SoC vendors is exhaustive in terms of being</span>
<span 
class="ptmri8t-">affected by </span><span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h</span></span>. We have followed responsive
disclosure during our discovery, which allowed almost all SoC
vendors to publicly release their respective patches already.
However, a substantial number of IoT products relying on
the affected SoCs for BLE connectivity will still need to
independently receive patches from their respective vendors, as
long as a firmware update mechanism is supported by the
vendor.
</p><!--l. 97--><p class="indent" >  <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>highlights concrete flaws in the BLE stack
certification process. We envision substantial amendments to the
BLE stack certification to avoid <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>style security
flaws. We also urge SoC vendors and IoT product manufacturers
to be aware of such security issues and to initiate focused effort
in security testing.
</p><!--l. 103--><p class="indent" >  A proper classification of the vulnerability set is presented in
the next section.
</p>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">1.1    </span> <a 
 id="x1-20001.1"></a>Types of vulnerabilities</h4>
<!--l. 107--><p class="noindent" >We have classified the <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>vulnerabilities according
to their types and their behaviours on the affected BLE
devices.
</p>
    <ul class="itemize1">
    <li class="itemize"><span 
class="ptmb8t-">Crash</span>:  Vulnerabilities  in  this  category  can  remotely
    crash a device by triggering hard faults. This happens
    due  to  some  incorrect  code  behaviour  or  memory
    corruption,   e.g.,   when   a   buffer   overflow   on   BLE
    reception  buffer  occurs.  When  a  device  crash  occurs,
    they usually restart. However, such a restart capability
    depends  on  whether  a  correct  hard  fault  handling
    mechanism was implemented in the product that uses
    the vulnerable BLE SoC.
    </li>
    <li class="itemize"><span 
class="ptmb8t-">Deadlock</span>: Deadlocks are vulnerabilities that affect the
    availability  of  the  BLE  connection  without  causing  a
    hard  fault  or  memory  corruption.  Usually  they  occur
    due  to  some  improper  synchronisation  between  user
    code  and  the  SDK  firmware  distributed  by  the  SoC
    vendor, leaving the user code being stuck at some point.               Crashes  originated  from  hard  faults,  if  not  properly
             handled,  can  become  a  deadlock  if  the  device  is  not
             automatically restarted. In most cases, when a deadlock
             occurs,  the  user  is  required  to  manually  power  off
             and  power  on  the  device  to  re-establish  proper  BLE
             communication.
             </li>
             <li class="itemize"><span 
class="ptmb8t-">Security Bypass</span>: This vulnerability is the most critical
             one. This is because the vulnerability allows attackers in
             radio range to bypass the latest secure pairing mode of
             BLE, i.e., the <span 
class="ptmri8t-">Secure Connections </span>pairing mode&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth2016bluetooth">12</a>]</span>.
             In summary, after the bypass is completed, an attacker
             in the radio range has arbitrary read or write access to
             device&#8217;s  functions.  These  functions,  in  turn,  are  only
             meant to be accessed by authorised users.
             </li></ul>
     <!--l. 136--><p class="indent" >    The summary of our findings and the affected vendors is
     depicted in Table <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-2001r1">1<!--tex4ht:ref: tab:v_types --></a>.
     </p>
         <div class="table row items-start justify-center">
                                                                                                
                                                                                                
<!--l. 2--><p class="indent" >  <a 
 id="x1-2001r1"></a></p><div class="float" 
>
                                                
                                                                                                
                                                                                                
 <div class="caption" 
><span class="id">Table&#x00A0;1: </span><span  
class="content">Vulnerabilities type and affected vendors</span></div><!--tex4ht:label?: x1-2001r1 -->
 <!--tex4ht:inline--><div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2" /></colgroup><colgroup id="TBL-2-3g"><col 
id="TBL-2-3" /></colgroup><colgroup id="TBL-2-4g"><col 
id="TBL-2-4" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:normal; text-align:center;" id="TBL-2-1-1"  
class="td11">      <span 
class="ptmbi8t-">Type            </span></td><td  style="white-space:normal; text-align:center;" id="TBL-2-1-2"  
class="td11">     <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmbi8t-">Vulnerability Name</span></div>         </td><td  style="white-space:normal; text-align:center;" id="TBL-2-1-3"  
class="td11">    <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmbi8t-">Affected Vendors</span></div>       </td><td  style="white-space:normal; text-align:center;" id="TBL-2-1-4"  
class="td11">         <span 
class="ptmbi8t-">CVE                  </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:normal; text-align:center;" id="TBL-2-2-1"  
class="td11">     <div class="multirow"><!-- rows=86422285 -->
<span 
class="ptmb8t-">Crash</span></div>           </td><td  style="white-space:normal; text-align:center;" id="TBL-2-2-2"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:center;"><div class="multirow"><!-- rows=86422285 -->
Link Layer Length Overflow</div></div>  </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-2-3"  
class="td11"> <div class="multicolumn"  style="white-space:wrap; text-align:left;">Cypress</div>                            </td><td  style="white-space:normal; text-align:center;" id="TBL-2-2-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16336" >CVE-2019-16336</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-100006.1">6.1<!--tex4ht:ref: sec:ll-length-overflow --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:normal; text-align:center;" id="TBL-2-3-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-3-2"  
class="td11">                         </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-3-3"  
class="td11"> <div class="multicolumn"  style="white-space:wrap; text-align:left;">NXP</div>                                </td><td  style="white-space:normal; text-align:center;" id="TBL-2-3-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17519" >CVE-2019-17519</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-100006.1">6.1<!--tex4ht:ref: sec:ll-length-overflow --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:normal; text-align:center;" id="TBL-2-4-1"  
class="td11"></td></tr><tr 
class="cline"><td></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:normal; text-align:center;" id="TBL-2-5-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-5-2"  
class="td11"> Truncated L2CAP                   </td><td  style="white-space:normal; text-align:left;" id="TBL-2-5-3"  
class="td11"> Dialog Semiconductors   </td><td  style="white-space:normal; text-align:center;" id="TBL-2-5-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17517" >CVE-2019-17517</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-120006.3">6.3<!--tex4ht:ref: sec:truncated_l2cap --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:normal; text-align:center;" id="TBL-2-6-1"  
class="td11"></td></tr><tr 
class="cline"><td></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="white-space:normal; text-align:center;" id="TBL-2-7-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-7-2"  
class="td11"> Silent Length Overflow           </td><td  style="white-space:normal; text-align:left;" id="TBL-2-7-3"  
class="td11"> Dialog Semiconductors   </td><td  style="white-space:normal; text-align:center;" id="TBL-2-7-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17518" >CVE-2019-17518</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-130006.4">6.4<!--tex4ht:ref: sec:silent_overflow --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="white-space:normal; text-align:center;" id="TBL-2-8-1"  
class="td11"></td></tr><tr 
class="cline"><td></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="white-space:normal; text-align:center;" id="TBL-2-9-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-9-2"  
class="td11"> Public Key Crash                     </td><td  style="white-space:normal; text-align:left;" id="TBL-2-9-3"  
class="td11"> Texas Instruments           </td><td  style="white-space:normal; text-align:center;" id="TBL-2-9-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17520" >CVE-2019-17520</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-150006.6">6.6<!--tex4ht:ref: sec:pub_key_crash --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="white-space:normal; text-align:center;" id="TBL-2-10-1"  
class="td11"></td></tr><tr 
class="cline"><td></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="white-space:normal; text-align:center;" id="TBL-2-11-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-11-2"  
class="td11"> Invalid L2CAP Fragment        </td><td  style="white-space:normal; text-align:left;" id="TBL-2-11-3"  
class="td11"> Microchip                        </td><td  style="white-space:normal; text-align:center;" id="TBL-2-11-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19195" >CVE-2019-19195</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-170006.8">6.8<!--tex4ht:ref: sec:invalid_fragment --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="white-space:normal; text-align:center;" id="TBL-2-12-1"  
class="td11"></td></tr><tr 
class="cline"><td></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="white-space:normal; text-align:center;" id="TBL-2-13-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-13-2"  
class="td11"> Key Size Overflow                  </td><td  style="white-space:normal; text-align:left;" id="TBL-2-13-3"  
class="td11"> Telink Semiconductor     </td><td  style="white-space:normal; text-align:center;" id="TBL-2-13-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19196" >CVE-2019-19196</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-180006.9">6.9<!--tex4ht:ref: sec:key_overflow --></a>)   </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="white-space:normal; text-align:center;" id="TBL-2-14-1"  
class="td11">    <div class="multirow"><!-- rows=86422285 -->
<span 
class="ptmb8t-">Deadlock</span></div>        </td><td  style="white-space:normal; text-align:left;" id="TBL-2-14-2"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
LLID Deadlock</div>                       </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-14-3"  
class="td11"> <div class="multicolumn"  style="white-space:wrap; text-align:left;">Cypress</div>                            </td><td  style="white-space:normal; text-align:center;" id="TBL-2-14-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17061" >CVE-2019-17061</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-110006.2">6.2<!--tex4ht:ref: sec:llid-deadlock --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-15-"><td  style="white-space:normal; text-align:center;" id="TBL-2-15-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-15-2"  
class="td11">                         </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-15-3"  
class="td11"> <div class="multicolumn"  style="white-space:wrap; text-align:left;">NXP</div>                                </td><td  style="white-space:normal; text-align:center;" id="TBL-2-15-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17060" >CVE-2019-17060</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-110006.2">6.2<!--tex4ht:ref: sec:llid-deadlock --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-16-"><td  style="white-space:normal; text-align:center;" id="TBL-2-16-1"  
class="td11"></td></tr><tr 
class="cline"><td></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-17-"><td  style="white-space:normal; text-align:center;" id="TBL-2-17-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-17-2"  
class="td11"> Sequential ATT Deadlock       </td><td  style="white-space:normal; text-align:left;" id="TBL-2-17-3"  
class="td11"> STMicroelectronics         </td><td  style="white-space:normal; text-align:center;" id="TBL-2-17-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19192" >CVE-2019-19192</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-160006.7">6.7<!--tex4ht:ref: sec:sequential_att --></a>)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-18-"><td  style="white-space:normal; text-align:center;" id="TBL-2-18-1"  
class="td11"></td></tr><tr 
class="cline"><td></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-19-"><td  style="white-space:normal; text-align:center;" id="TBL-2-19-1"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-2-19-2"  
class="td11"> Invalid Connection Request    </td><td  style="white-space:normal; text-align:left;" id="TBL-2-19-3"  
class="td11"> Texas Instruments           </td><td  style="white-space:normal; text-align:center;" id="TBL-2-19-4"  
class="td11">  <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19193" >CVE-2019-19193</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-140006.5">6.5<!--tex4ht:ref: sec:invalid_conn --></a>)   </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-20-"><td  style="white-space:normal; text-align:center;" id="TBL-2-20-1"  
class="td11"> <span 
class="ptmb8t-">Security Bypass  </span></td><td  style="white-space:normal; text-align:left;" id="TBL-2-20-2"  
class="td11"> Zero LTK Installation              </td><td  style="white-space:normal; text-align:left;" id="TBL-2-20-3"  
class="td11"> Telink Semiconductor     </td><td  style="white-space:normal; text-align:center;" id="TBL-2-20-4"  
class="td11"> <a 
target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19194" >CVE-2019-19194</a> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-190006.10">6.10<!--tex4ht:ref: sec:zero_ltk --></a>)  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-21-"><td  style="white-space:normal; text-align:center;" id="TBL-2-21-1"  
class="td11">                </td></tr></table>                                                                          </div>
                                                
                                                                                                
                                                                                                
  </div>
  </div>
  <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">2    </span> <a 
 id="x1-30002"></a><a id="affected-devices">Vulnerable BLE chips</a></h3>
<!--l. 155--><p class="noindent" >Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-3001r2">2<!--tex4ht:ref: tab:affected_socs --></a> lists the affected SoCs and the respective SDK versions
where the vulnerabilities were found. The qualification ID of
each SoC, attributed to vendors after their SDK is certified,
allows to search for products using the SoC connected to such ID
on the Bluetooth Listing Search site&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth-listing">14</a>]</span>. A basic search
on this site yields about <span id="textcolor5"><span 
class="ptmb8t-">480 products listings using the</span>
<span 
class="ptmb8t-">affected SoCs</span></span> from Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-3001r2">2<!--tex4ht:ref: tab:affected_socs --></a>. Each listing may contain
multiple products from the same vendor, which further
increases the total number of different products affected. This
does not mean, however, that all products are guaranteed to
be affected. This is because the impact of <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span></span>
vulnerabilities depends on how the product software handles
BLE communication and how much it relies on affected SoCs to
operate.
</p>
  <div class="table row items-start justify-center">
                                                
                                                                                                
                                                                                                
<!--l. 7--><p class="indent" >  <a 
 id="x1-3001r2"></a></p><div class="float" 
>
                                                
                                                                                                
                                                                                                
 <div class="caption" 
><span class="id">Table&#x00A0;2: </span><span  
class="content">Vulnerabilities and SDK versions of the affected
SoCs.* indicates extra affected SoCs reported by the vendor
not tracked by our team.</span></div><!--tex4ht:label?: x1-3001r2 -->
 <!--tex4ht:inline--><div class="tabular"> <table id="TBL-3" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1" /><col 
id="TBL-3-2" /><col 
id="TBL-3-3" /><col 
id="TBL-3-4" /><col 
id="TBL-3-5" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:normal; text-align:center;" id="TBL-3-1-1"  
class="td11">  <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmb8t-">Vuln.</span></div>    </td><td  style="white-space:normal; text-align:center;" id="TBL-3-1-2"  
class="td11">     <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmbi8t-">SoC Vendor</span></div>         </td><td  style="white-space:normal; text-align:center;" id="TBL-3-1-3"  
class="td11">   <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmbi8t-">SoC Model</span></div>      </td><td  style="white-space:normal; text-align:center;" id="TBL-3-1-4"  
class="td11">  <span 
class="ptmbi8t-">SDK Ver.    </span></td><td  style="white-space:normal; text-align:center;" id="TBL-3-1-5"  
class="td11">        <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmbi8t-">Qualification ID(s)</span></div>
</td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:normal; text-align:center;" id="TBL-3-2-1"  
class="td11">         </td><td  style="white-space:normal; text-align:left;" id="TBL-3-2-2"  
class="td11"> <span 
class="ptmbi8t-">BLE Version 5.0/5.1  </span></td><td  style="white-space:normal; text-align:left;" id="TBL-3-2-3"  
class="td11">               </td><td  style="white-space:normal; text-align:left;" id="TBL-3-2-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;"></div>          </td><td  style="white-space:normal; text-align:right;" id="TBL-3-2-5"  
class="td11">                                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:normal; text-align:center;" id="TBL-3-3-1"  
class="td11"> <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-100006.1">6.1<!--tex4ht:ref: sec:ll-length-overflow --></a>,<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-110006.2">6.2<!--tex4ht:ref: sec:llid-deadlock --></a> </td> <td  style="white-space:normal; text-align:left;" id="TBL-3-3-2"  
class="td11"> Cypress (PSoC 6) </td> <td  style="white-space:normal; text-align:left;" id="TBL-3-3-3"  
class="td11"> CYBLE-416045 </td> <td  style="white-space:normal; text-align:center;" id="TBL-3-3-4"  
class="td11"> 2.10 </td> <td  style="white-space:normal; text-align:right;" id="TBL-3-3-5"  
class="td11"> 99158</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:normal; text-align:center;" id="TBL-3-4-1"  
class="td11">  <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-140006.5">6.5<!--tex4ht:ref: sec:invalid_conn --></a>,<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-150006.6">6.6<!--tex4ht:ref: sec:pub_key_crash --></a>   </td><td  style="white-space:normal; text-align:left;" id="TBL-3-4-2"  
class="td11"> Texas Instruments       </td><td  style="white-space:normal; text-align:left;" id="TBL-3-4-3"  
class="td11"> CC2640R2           </td><td  style="white-space:normal; text-align:center;" id="TBL-3-4-4"  
class="td11">  3.30.00.20   </td><td  style="white-space:normal; text-align:right;" id="TBL-3-4-5"  
class="td11">                          94079  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="white-space:normal; text-align:center;" id="TBL-3-5-1"  
class="td11"> <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-180006.9">6.9<!--tex4ht:ref: sec:key_overflow --></a>,<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-190006.10">6.10<!--tex4ht:ref: sec:zero_ltk --></a>  </td><td  style="white-space:normal; text-align:left;" id="TBL-3-5-2"  
class="td11"> Telink                          </td><td  style="white-space:normal; text-align:left;" id="TBL-3-5-3"  
class="td11"> TLSR8258           </td><td  style="white-space:normal; text-align:center;" id="TBL-3-5-4"  
class="td11">    3.4.0        </td><td  style="white-space:normal; text-align:right;" id="TBL-3-5-5"  
class="td11">                   92269, 136037  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-6-"><td  style="white-space:normal; text-align:center;" id="TBL-3-6-1"  
class="td11">   <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-160006.7">6.7<!--tex4ht:ref: sec:sequential_att --></a>      </td><td  style="white-space:normal; text-align:left;" id="TBL-3-6-2"  
class="td11"> STMicroelectronics    </td><td  style="white-space:normal; text-align:left;" id="TBL-3-6-3"  
class="td11"> WB55                  </td><td  style="white-space:normal; text-align:center;" id="TBL-3-6-4"  
class="td11">    1.3.0        </td><td  style="white-space:normal; text-align:right;" id="TBL-3-6-5"  
class="td11">                         111668  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-7-"><td  style="white-space:normal; text-align:center;" id="TBL-3-7-1"  
class="td11"> <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-160006.7">6.7<!--tex4ht:ref: sec:sequential_att --></a> </td> <td  style="white-space:normal; text-align:left;" id="TBL-3-7-2"  
class="td11"> STMicroelectroncis </td> <td  style="white-space:normal; text-align:left;" id="TBL-3-7-3"  
class="td11"> BlueNRG-2 </td> <td  style="white-space:normal; text-align:center;" id="TBL-3-7-4"  
class="td11"> 3.1.0 </td> <td  style="white-space:normal; text-align:right;" id="TBL-3-7-5"  
class="td11"> 87428, 106700, 94075</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-8-"><td  style="white-space:normal; text-align:center;" id="TBL-3-8-1"  
class="td11">   <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-130006.4">6.4<!--tex4ht:ref: sec:silent_overflow --></a>      </td><td  style="white-space:normal; text-align:left;" id="TBL-3-8-2"  
class="td11"> Dialog                         </td><td  style="white-space:normal; text-align:left;" id="TBL-3-8-3"  
class="td11"> DA1469X*          </td><td  style="white-space:normal; text-align:center;" id="TBL-3-8-4"  
class="td11">   10.0.6       </td><td  style="white-space:normal; text-align:right;" id="TBL-3-8-5"  
class="td11">                         100899  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-9-"><td  style="white-space:normal; text-align:center;" id="TBL-3-9-1"  
class="td11">   <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-120006.3">6.3<!--tex4ht:ref: sec:truncated_l2cap --></a>      </td><td  style="white-space:normal; text-align:left;" id="TBL-3-9-2"  
class="td11"> Dialog                         </td><td  style="white-space:normal; text-align:left;" id="TBL-3-9-3"  
class="td11"> DA14585/6*        </td><td  style="white-space:normal; text-align:center;" id="TBL-3-9-4"  
class="td11"> 6.0.12.1020  </td><td  style="white-space:normal; text-align:right;" id="TBL-3-9-5"  
class="td11">                          91436  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-10-"><td  style="white-space:normal; text-align:center;" id="TBL-3-10-1"  
class="td11">         </td><td  style="white-space:normal; text-align:left;" id="TBL-3-10-2"  
class="td11"> <span 
class="ptmbi8t-">BLE Version 4.2         </span></td><td  style="white-space:normal; text-align:left;" id="TBL-3-10-3"  
class="td11">               </td><td  style="white-space:normal; text-align:center;" id="TBL-3-10-4"  
class="td11">            </td><td  style="white-space:normal; text-align:right;" id="TBL-3-10-5"  
class="td11">                                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-11-"><td  style="white-space:normal; text-align:center;" id="TBL-3-11-1"  
class="td11"> <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-100006.1">6.1<!--tex4ht:ref: sec:ll-length-overflow --></a>,<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-110006.2">6.2<!--tex4ht:ref: sec:llid-deadlock --></a> </td> <td  style="white-space:normal; text-align:left;" id="TBL-3-11-2"  
class="td11"> Cypress (PSoC 4) </td> <td  style="white-space:normal; text-align:left;" id="TBL-3-11-3"  
class="td11"> CYBL11573 </td> <td  style="white-space:normal; text-align:center;" id="TBL-3-11-4"  
class="td11"> 3.60 </td> <td  style="white-space:normal; text-align:right;" id="TBL-3-11-5"  
class="td11"> 62243, 136808, 79697, 82951, 79480</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-12-"><td  style="white-space:normal; text-align:center;" id="TBL-3-12-1"  
class="td11">  <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-100006.1">6.1<!--tex4ht:ref: sec:ll-length-overflow --></a>,<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-110006.2">6.2<!--tex4ht:ref: sec:llid-deadlock --></a>   </td><td  style="white-space:normal; text-align:left;" id="TBL-3-12-2"  
class="td11"> NXP                            </td><td  style="white-space:normal; text-align:left;" id="TBL-3-12-3"  
class="td11"> KW41Z                </td><td  style="white-space:normal; text-align:center;" id="TBL-3-12-4"  
class="td11">    2.2.1        </td><td  style="white-space:normal; text-align:right;" id="TBL-3-12-5"  
class="td11">                          84040  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-13-"><td  style="white-space:normal; text-align:center;" id="TBL-3-13-1"  
class="td11">   <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-130006.4">6.4<!--tex4ht:ref: sec:silent_overflow --></a>      </td><td  style="white-space:normal; text-align:left;" id="TBL-3-13-2"  
class="td11"> Dialog                         </td><td  style="white-space:normal; text-align:left;" id="TBL-3-13-3"  
class="td11"> DA14680             </td><td  style="white-space:normal; text-align:center;" id="TBL-3-13-4"  
class="td11">  1.0.14.X     </td><td  style="white-space:normal; text-align:right;" id="TBL-3-13-5"  
class="td11">        87407, 84084, 71309, 75255  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-14-"><td  style="white-space:normal; text-align:center;" id="TBL-3-14-1"  
class="td11">         </td><td  style="white-space:normal; text-align:left;" id="TBL-3-14-2"  
class="td11"> <span 
class="ptmbi8t-">BLE Version 4.1         </span></td><td  style="white-space:normal; text-align:left;" id="TBL-3-14-3"  
class="td11">               </td><td  style="white-space:normal; text-align:center;" id="TBL-3-14-4"  
class="td11">            </td><td  style="white-space:normal; text-align:right;" id="TBL-3-14-5"  
class="td11">                                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-15-"><td  style="white-space:normal; text-align:center;" id="TBL-3-15-1"  
class="td11"> <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-140006.5">6.5<!--tex4ht:ref: sec:invalid_conn --></a> </td> <td  style="white-space:normal; text-align:left;" id="TBL-3-15-2"  
class="td11"> Texas Instruments </td> <td  style="white-space:normal; text-align:left;" id="TBL-3-15-3"  
class="td11"> CC2540 </td> <td  style="white-space:normal; text-align:center;" id="TBL-3-15-4"  
class="td11"> 1.5.0 </td> <td  style="white-space:normal; text-align:right;" id="TBL-3-15-5"  
class="td11"> 23454, 127418</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-16-"><td  style="white-space:normal; text-align:center;" id="TBL-3-16-1"  
class="td11">   <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-120006.3">6.3<!--tex4ht:ref: sec:truncated_l2cap --></a>      </td><td  style="white-space:normal; text-align:left;" id="TBL-3-16-2"  
class="td11"> Dialog                         </td><td  style="white-space:normal; text-align:left;" id="TBL-3-16-3"  
class="td11"> DA14580             </td><td  style="white-space:normal; text-align:center;" id="TBL-3-16-4"  
class="td11">    5.0.4        </td><td  style="white-space:normal; text-align:right;" id="TBL-3-16-5"  
class="td11">                          83573  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-17-"><td  style="white-space:normal; text-align:center;" id="TBL-3-17-1"  
class="td11">   <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-170006.8">6.8<!--tex4ht:ref: sec:invalid_fragment --></a>      </td><td  style="white-space:normal; text-align:left;" id="TBL-3-17-2"  
class="td11"> Microchip                   </td><td  style="white-space:normal; text-align:left;" id="TBL-3-17-3"  
class="td11"> ATSAMB11         </td><td  style="white-space:normal; text-align:center;" id="TBL-3-17-4"  
class="td11">     6.2         </td><td  style="white-space:normal; text-align:right;" id="TBL-3-17-5"  
class="td11">                          73346  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-18-"><td  style="white-space:normal; text-align:center;" id="TBL-3-18-1"  
class="td11">         </td></tr></table>                                                                                     </div>
                                                
                                                                                                
                                                                                                
  </div>
  </div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">2.1    </span> <a 
 id="x1-40002.1"></a>Attacks on IoT</h4>
  <div class="table row items-start justify-center">
                                                
                                                                                                
                                                                                                
<!--l. 7--><p class="indent" >  <a 
 id="x1-4001r3"></a></p><div class="float" 
>
                                                
                                                                                                
                                                                                                
 <div class="caption" 
><span class="id">Table&#x00A0;3: </span><span  
class="content">Products verified to be vulnerable</span></div><!--tex4ht:label?: x1-4001r3 -->
 <!--tex4ht:inline--><div class="tabular"> <table id="TBL-4" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1" /><col 
id="TBL-4-2" /><col 
id="TBL-4-3" /><col 
id="TBL-4-4" /><col 
id="TBL-4-5" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="white-space:normal; text-align:center;" id="TBL-4-1-1"  
class="td11">       <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmb8t-">Product</span></div>              </td><td  style="white-space:normal; text-align:left;" id="TBL-4-1-2"  
class="td11"> <span 
class="ptmb8t-">Category             </span></td><td  style="white-space:normal; text-align:left;" id="TBL-4-1-3"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;"><span 
class="ptmb8t-">BLE SoC</span></div>       </td><td  style="white-space:normal; text-align:left;" id="TBL-4-1-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;"><span 
class="ptmb8t-">Vulnerability</span></div>                                 </td><td  style="white-space:normal; text-align:left;" id="TBL-4-1-5"  
class="td11"> <span 
class="ptmb8t-">Impact      </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="white-space:normal; text-align:left;" id="TBL-4-2-1"  
class="td11"> <span 
class="ptmb8t-">Eve Energy                    </span></td><td  style="white-space:normal; text-align:left;" id="TBL-4-2-2"  
class="td11"> Smart Home         </td><td  style="white-space:normal; text-align:left;" id="TBL-4-2-3"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
DA14680</div>       </td><td  style="white-space:normal; text-align:left;" id="TBL-4-2-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;"><div class="multirow"><!-- rows=86422285 -->
(<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-130006.4">6.4<!--tex4ht:ref: sec:silent_overflow --></a>) Silent Length Overflow </div></div>        </td><td  style="white-space:normal; text-align:left;" id="TBL-4-2-5"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
<span id="textcolor6">Crash</span></div>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="white-space:normal; text-align:left;" id="TBL-4-3-1"  
class="td11"> <span 
class="ptmb8t-">August Smart Lock      </span></td><td  style="white-space:normal; text-align:left;" id="TBL-4-3-2"  
class="td11"> Smart Home         </td><td  style="white-space:normal; text-align:left;" id="TBL-4-3-3"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
DA14680</div>       </td><td  style="white-space:normal; text-align:left;" id="TBL-4-3-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;"><div class="multirow"><!-- rows=86422285 -->
(<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-130006.4">6.4<!--tex4ht:ref: sec:silent_overflow --></a>) Silent Length Overflow </div></div>        </td><td  style="white-space:normal; text-align:left;" id="TBL-4-3-5"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
<span id="textcolor7">Crash</span></div>        </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="white-space:normal; text-align:left;" id="TBL-4-4-1"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
<span 
class="ptmb8t-">Fitbit Inspire</span></div>                 </td><td  style="white-space:normal; text-align:left;" id="TBL-4-4-2"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
Wearables</div>             </td><td  style="white-space:normal; text-align:left;" id="TBL-4-4-3"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
CY8C68237</div>  </td><td  style="white-space:normal; text-align:left;" id="TBL-4-4-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;">(<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-100006.1">6.1<!--tex4ht:ref: sec:ll-length-overflow --></a>) LL Length Overflow</div>              </td><td  style="white-space:normal; text-align:left;" id="TBL-4-4-5"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
<span id="textcolor8">Crash</span></div>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-5-"><td  style="white-space:normal; text-align:left;" id="TBL-4-5-1"  
class="td11">                     </td><td  style="white-space:normal; text-align:left;" id="TBL-4-5-2"  
class="td11">                </td><td  style="white-space:normal; text-align:left;" id="TBL-4-5-3"  
class="td11">            </td><td  style="white-space:normal; text-align:left;" id="TBL-4-5-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;">(<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-110006.2">6.2<!--tex4ht:ref: sec:llid-deadlock --></a>) LLID Deadlock </div>                    </td><td  style="white-space:normal; text-align:left;" id="TBL-4-5-5"  
class="td11"> <div class="multirow"><!-- rows=86422285 -->
<span id="textcolor9">Crash</span></div>        </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-6-"><td  style="white-space:normal; text-align:left;" id="TBL-4-6-1"  
class="td11"> <span 
class="ptmb8t-">CubiTag                         </span></td><td  style="white-space:normal; text-align:left;" id="TBL-4-6-2"  
class="td11"> Gadget Tracking  </td><td  style="white-space:normal; text-align:left;" id="TBL-4-6-3"  
class="td11"> CC2640R2     </td><td  style="white-space:normal; text-align:left;" id="TBL-4-6-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;">(<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-150006.6">6.6<!--tex4ht:ref: sec:pub_key_crash --></a>) Public Key Crash</div>                   </td><td  style="white-space:normal; text-align:left;" id="TBL-4-6-5"  
class="td11"> <span id="textcolor10">Deadlock</span>  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-7-"><td  style="white-space:normal; text-align:left;" id="TBL-4-7-1"  
class="td11"> <span 
class="ptmb8t-">eGeeTouch TSA Lock  </span></td><td  style="white-space:normal; text-align:left;" id="TBL-4-7-2"  
class="td11"> Security                </td><td  style="white-space:normal; text-align:left;" id="TBL-4-7-3"  
class="td11"> CC2540         </td><td  style="white-space:normal; text-align:left;" id="TBL-4-7-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;">(<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-140006.5">6.5<!--tex4ht:ref: sec:invalid_conn --></a>) Invalid Connection Request</div>  </td><td  style="white-space:normal; text-align:left;" id="TBL-4-7-5"  
class="td11"> <span id="textcolor11">Deadlock</span>  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-8-"><td  style="white-space:normal; text-align:left;" id="TBL-4-8-1"  
class="td11">                     </td></tr></table>                                                                          </div>
                                                
                                                                                                
                                                                                                
  </div>
  </div>
<!--l. 180--><p class="indent" >  The exploitation of the vulnerabilities translates to dangerous
attack vectors against many IoT products released in 2018-2019.
At first glance, most of the vulnerabilities affect product&#8217;s
availability by allowing them to be remotely restarted, deadlocked
or having their security bypassed. In order to raise awareness
of the threats and risks of potentially vulnerable products
already on the market, we have performed attacks on five
representative IoT products which use the affected SoCs (cf.
Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-3001r2">2<!--tex4ht:ref: tab:affected_socs --></a>) as their main processor. These products are shown in
Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-4002r2">2<!--tex4ht:ref: fig:affected_products --></a>.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-4002r2"></a>
                                                
                                                                                                
                                                                                                
<!--l. 208--><p class="noindent" > <img 
src="Figures/all_products.pdf.svg" alt="PIC"  
width="360" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">An illustration of some vulnerable products.</span></div><!--tex4ht:label?: x1-4002r2 -->
                                                
                                                                                                
                                                                                                
  </div></div>
    <ul class="itemize1">
    <li class="itemize"><span 
class="ptmb8t-">Wearables: Fitbit Inspire </span>- Latest 2018 smartwatches
    line-up from FitBit uses the Cypress PSoC 6 as the main
    processor.  Hence  they  are  vulnerable  to  <span 
class="ptmri8t-">Link  Layer</span>
    <span 
class="ptmri8t-">Overflow </span>and <span 
class="ptmri8t-">LLID Deadlock</span>. To verify what happens
    to the wearable when both issues are exploited, we have
    sent malicious packets to the Fitbit Inspire smartwatch
    (Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-4002r2">2<!--tex4ht:ref: fig:affected_products_a --></a>a) through the BLE communication channel.
    <!--l. 227--><p class="noindent" >Once  the  malicious  packets  are  sent  to  the  device,
    it   is   possible   to   trigger   either   a   buffer   overflow
    in  device&#8217;s  memory  or  deadlock  its  bluetooth  stack
    temporarily. The former attack (exploiting <span 
class="ptmri8t-">Link Layer</span>
    <span 
class="ptmri8t-">Overflow</span>)   immediately   restarts   the   device   whereas
    the   latter   (exploiting   <span 
class="ptmri8t-">LLID   Deadlock</span>)   disables   its
    bluetooth advertisement for about 27 seconds before the
    smartwatch is automatically restarted by the firmware.
    </p><!--l. 234--><p class="noindent" >In     summary,     the     vulnerabilities     only     seem
    to temporarily block the availability of Fitbit. However,
    the <span 
class="ptmri8t-">Link Layer Length Overflow </span>is a serious threat by
    itself. Specifically, such an overflow is a potential front
    door  to  remote  execution  once  an  attacker  knows  the
    memory  layout  of  the  firmware  by  means  of  reverse
    engineering it. Similar behaviour is expected in Fitbit
    Charge  3  and  Ace  2.  This  is  because  they  embed
    Cypress PSoC 6 as their main processor.
    </p></li>
    <li class="itemize"><span 
class="ptmb8t-">Smart   Home:   Eve   Systems   </span>-   Many   smart   home
    products from Eve Systems are vulnerable due to their
    reliance  on  Dialog  DA14680  as  the  main  processor.
    For instance, Eve Light Switch, Eve Motion MKII, Eve
    Aqua, Eve Thermo MKII, Eve Room, Eve Lock, etc,
    are all prone to <span 
class="ptmri8t-">Silent Length Overflow</span>. Specifically, it
    is possible to crash such devices by sending a specific
    packet which overflows device&#8217;s reception buffer. When
    an attack occurs, the user can immediately experience
    her smart products restarting or getting unstable. As an
    example, when performing the <span 
class="ptmri8t-">Silent Length Overflow</span>
    against the <span 
class="ptmb8t-">Eve Energy </span>(Figure <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-4002r2">2<!--tex4ht:ref: fig:affected_products_b --></a>b), the power on the
    smart  plug  is  cut  off  when  its  processor  crashes  and
    restarts.  As  a  consequence,  we  can  momentarily  cut
    the power to anything connected in the socket by just
    sending  a  malicious  packet  within  radio  range  of  the
    smart  socket.  Furthermore,  an  attacker  can  use  this
    simple attack to cause real damage to some equipment
    connected  to  the  plug  by  intermittently  cutting  its
    power.
    <!--l. 257--><p class="noindent" ><span 
class="ptmb8t-">August Smart Lock </span>- We have verified that the <span 
class="ptmri8t-">Silent</span>
    <span 
class="ptmri8t-">Length Overflow </span>also affects the popular <span 
class="ptmb8t-">August Smart</span>
    <span 
class="ptmb8t-">Lock </span>(Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-4002r2">2<!--tex4ht:ref: fig:affected_products_c --></a>c). Such a smart lock remotely controls
    access to house doors. Hence, it is advisable that users
    update their affected devices as soon as possible. This is               to avoid a worst-case exploit, which could grant access
             control to a thief by means of remote execution.
             </p></li>
             <li class="itemize"><span 
class="ptmb8t-">Tracking Gadget: CubiTag </span>- The <span 
class="ptmri8t-">CubiTag </span>Bluetooth
             tracker is a popular product that tracks the belongings of
             a user (Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-4002r2">2<!--tex4ht:ref: fig:affected_products_d --></a>d). When the tracker is near an object
             of  interest,  it  can  be  found  by  using  a  mobile  app,
             which searches for the tracker and starts an alarm on
             the tracker. As a result, the user can hear the alarm and
             find the object. However, <span 
class="ptmri8t-">CubiTag </span>relies on a vulnerable
             TI CC2640R2 SDK. Out of two vulnerabilities on this
             SDK, only the <span 
class="ptmri8t-">Public Key Crash </span>affects availability of
             CubiTag.  The  CubiTag  immediately  stops  advertising
             itself  and  is  never  found  by  the  mobile  app  again;
             hence it is deadlocked. <span 
class="ptmri8t-">The CubiTag device only works</span>
             <span 
class="ptmri8t-">again   by   manually   opening   it   with   a   screwdriver</span>
             <span 
class="ptmri8t-">and  re-inserting  its  battery</span>.  This  is  for  the  tracker
             SoC  to  reboot  properly  and  to  establish  normal  BLE
             connection.
             </li>
             <li class="itemize"><span 
class="ptmb8t-">Smart Locks: eGee Touch </span>- The eGee Touch, shown in
             Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-4002r2">2<!--tex4ht:ref: fig:affected_products_e --></a>e, is a smart luggage lock that can be remotely
             locked or unlocked through a smartphone app. During
             our  tests,  as  the  device  uses  the  TI  CC2540  SoC,
             we  could  lead  the  smart  lock  in  a  deadlock  state  by
             exploiting the <span 
class="ptmri8t-">Invalid Connection Request </span>vulnerability.
             When  an  attack  is  carried  out,  the  device  hangs  and
             the user needs to manually press the <span 
class="ptmri8t-">power on </span>button
             on  the  smart  lock  to  re-interact  with  it.  This  is  not
             a  critical  problem  by  itself.  However,  the  worst-case
             scenario  occurs  when  the  user  enables  continuous
             advertisement  on  the  smart  lock.  This  prevents  the
             device to automatically restart after the attack, hence its
             batteries must be re-inserted to reboot its processor and
             restore functionalities back to normal.</li></ul> <iframe class="table_image resize_table" width="560" height="315" src="https://www.youtube.com/embed/rge1XeJVpag" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
         <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">2.2    </span> <a 
 id="x1-50002.2"></a>Other potentially vulnerable products</h4>
     <!--l. 294--><p class="noindent" >As mentioned in Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-30002">2<!--tex4ht:ref: sec:vulnerable_socs --></a>, the vulnerabilities discovered by our
     team are likely to affect a substantial number of products that
     rely on the affected SoCs. While it is difficult to confirm the
     reach of such vulnerabilities for every product out in the wild, we
     provide an overview of the types of products potentially
     affected by <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>using the Bluetooth Listing
     Search site&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth-listing">14</a>]</span>. Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-5001r3">3<!--tex4ht:ref: fig:listings --></a> captures the total number of
     products listings using the affected SoCs as of 8th February,
     2020.
     </p>
         <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-5001r3"></a>
                                                
                                                                                                
                                                                                                
<!--l. 304--><p class="noindent" > <img 
src="Figures/affected_products.pdf.svg" alt="PIC"  
width="420" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;3: </span><span  
class="content">Number of product listings for each SoC affected
as of February 8, 2020.</span></div><!--tex4ht:label?: x1-5001r3 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 312--><p class="indent" >  While the majority of products are listed under CC2540, we
note several critical BLE products using the other affected SoC
vendors. These products are applied to <span id="textcolor12"><span 
class="ptmb8t-">logistics, medical,</span>
<span 
class="ptmb8t-">consumer electronics, smart home, wearables</span></span> and other fields.
Although it is impractical for our team to verify such a large
number of products using the affected SoCs, we outline some of
the most notorious or popular products found on Bluetooth
Listing website&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth-listing">14</a>]</span>. These critical products are shown in
Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-5002r4">4<!--tex4ht:ref: tab:prods --></a>.
                                                
                                                                                                
                                                                                                
</p><!--l. 7--><p class="indent" >  <a 
 id="x1-5002r4"></a></p><div class="float" 
>
                                                
                                                                                                
                                                                                                
 <div class="caption" 
><span class="id">Table&#x00A0;4: </span><span  
class="content">Some notorious products using SoCs affected by <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h</span></span>. The declaration ID references each product on the
Bluetooth Listing Search&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth-listing">14</a>]</span>.</span></div><!--tex4ht:label?: x1-5002r4 -->
 <img 
width="80%" class="resize_table table_image" src="Tables/prods_affected.png" alt="PIC"  
 />
                                                
                                                                                                
                                                                                                
  </div>
<!--l. 323--><p class="indent" >  The most critical devices that could be severely impacted
by <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>are the medical products. VivaCheck
Laboratories, which manufacture Blood Glucose Meters, has
many products listed to use DA14580. Hence all these products
are potentially vulnerable to the Truncated L2CAP attack.
Even worse, Syqe Medical Ltd. and their programmable
drug delivery inhalation platform (<span 
class="ptmb8t-">Syqe Inhaler v01</span>) is
affected alongside the latest pacemaker related products from
Medtronic Inc. While our team did not verify the extent to which
<span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>affects such devices (e.g. the impact of remotely
restarting such devices or remote code execution in the
worst case), it is highly recommended that such companies
update their firmware. This is to avoid any situation that
could pose life threatening risks to the patients using the
respective medical products. Unfortunately, the security issue
found in Dialog DA14580 is still unpatched (cf. Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6001r5">5<!--tex4ht:ref: tab:patches --></a>).
Nonetheless, Dialog is working on an internal security patch for
DA14580 and will release it for general public in the next
SDK release. More details about patches are mentioned in
Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-60003">3<!--tex4ht:ref: sec:patches --></a>.
</p><!--l. 338--><p class="indent" >  Another complication arises for the IN180-13 from Swipbox
International. This product uses the vulnerable KW41Z SoC
from the vendor NXP semiconductor. According to the company
page&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xswipbox">15</a>]</span>, the battery operated product is an automatic parcel
locker and has no display. Instead, it relies entirely on a
smartphone application communicating via BLE to unlock the
parcel sent to the recipient. Similarly to what happens to
CubiTag, the KW41Z is vulnerable to a deadlock (LLID
Deadlock). The KW41Z LLID deadlock vulnerability is
particularly easy to trigger and allows an attacker in radio range
to simply block anyone to connect to the parcel locker (unless the
the parcel locker is automatically restarted). Fortunately, NXP
has already released patches for the two vulnerabilities
affecting KW41Z. Other potentially vulnerable popular
products include vendors such as August Home, Eve Systems,
Samsung and Anhui Huami Information Technology, among
others.
</p><!--l. 351--><p class="indent" >  <span 
class="ptmri8t-">It is worthwhile to note that the list in Table</span><span 
class="ptmri8t-">&#x00A0;</span><a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-5002r4"><span 
class="ptmri8t-">4</span><!--tex4ht:ref: tab:prods --></a> <span 
class="ptmri8t-">is not</span>
<span 
class="ptmri8t-">exhaustive. Thus, we recommend each product vendor to update</span>
<span 
class="ptmri8t-">the SDK firmware of their products to the latest if available or</span>
<span 
class="ptmri8t-">contact their SoC vendor to enquire on the status of the</span>
<span 
class="ptmri8t-">patch.</span>
</p>
  <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">3    </span> <a 
 id="x1-60003"></a><a id="patches">Security Patches</a></h3>
<!--l. 360--><p class="noindent" >Most of the affected vendors have released patches for their
respective SoCs. One can get the latest patches by downloading
the newest SDK of each vendor referenced in Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6001r5">5<!--tex4ht:ref: tab:patches --></a>. Product
vendors (who use the affected SoCs), on the other hand, are
being independently contacted by each SoC vendor to inform
about the security patches. However, we note that some SoCs did not receive a patch from their vendor yet. This is the case for
  Dialog, Microchip and STMicroelectroncs. We will be updating
  this section once vendors release the security patches for the
  affected SoCs.
  </p><!--l. 369--><p class="indent" >  We urge action from vendors due to the reliance of the BLE
  IoT market on such unpatched SoCs. For example, <span 
class="ptmb8t-">August</span>
  <span 
class="ptmb8t-">Home Inc </span>and <span 
class="ptmb8t-">Eve Systems </span>products rely almost entirely on
  <span 
class="ptmb8t-">DA14680</span>, which is still <span 
class="ptmri8t-">unpatched </span>even after a responsive
  disclosure period of more than 90 days.
  </p><!--l. 374--><p class="indent" >  During our contact with Dialog, they have confirmed that a
  patch is planned in the next SDK release for the affected SoCs.
  We were also informed that the reason of such delay is due to the
  affected code being stored in the read-only-memory (ROM) of
  such SoCs. Thus, the respective vulnerable BLE stack cannot be
  modified and it requires complex workarounds for publicly
  releasing a patch.
  </p>
    <div class="table row items-start justify-center">
                                                                                                
                                                                                                
<!--l. 7--><p class="indent" >  <a 
 id="x1-6001r5"></a></p><div class="float" 
>
                                                
                                                                                                
                                                                                                
 <div class="caption" 
><span class="id">Table&#x00A0;5: </span><span  
class="content">Patches available by the SoC vendors.</span></div><!--tex4ht:label?: x1-6001r5 -->
 <!--tex4ht:inline--><div class="tabular"> <table id="TBL-5" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-5-1g"><col 
id="TBL-5-1" /><col 
id="TBL-5-2" /><col 
id="TBL-5-3" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-1-"><td  style="white-space:normal; text-align:center;" id="TBL-5-1-1"  
class="td11">    <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmbi8t-">SoC Vendor</span></div>        </td><td  style="white-space:normal; text-align:center;" id="TBL-5-1-2"  
class="td11">   <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmbi8t-">SoC Model</span></div>      </td><td  style="white-space:normal; text-align:center;" id="TBL-5-1-3"  
class="td11">        <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmbi8t-">Vendor Patches</span></div>
</td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-2-"><td  style="white-space:normal; text-align:left;" id="TBL-5-2-1"  
class="td11"> Cypress (PSoC 6)      </td><td  style="white-space:normal; text-align:left;" id="TBL-5-2-2"  
class="td11"> CYBLE-416045  </td><td  style="white-space:normal; text-align:left;" id="TBL-5-2-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xpsoc6sdk">4</a>]</span> BLE_PDL 2.2                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-3-"><td  style="white-space:normal; text-align:left;" id="TBL-5-3-1"  
class="td11"> Cypress (PSoC 4)      </td><td  style="white-space:normal; text-align:left;" id="TBL-5-3-2"  
class="td11"> CYBL11573        </td><td  style="white-space:normal; text-align:left;" id="TBL-5-3-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xpsoc4sdk">3</a>]</span> BLE Component 3.63             </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-4-"><td  style="white-space:normal; text-align:left;" id="TBL-5-4-1"  
class="td11"> NXP                          </td><td  style="white-space:normal; text-align:left;" id="TBL-5-4-2"  
class="td11"> KW41Z                </td><td  style="white-space:normal; text-align:left;" id="TBL-5-4-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xnxpsdk">8</a>]</span> 2.2.1 (2019-11-28)                  </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-5-"><td  style="white-space:normal; text-align:left;" id="TBL-5-5-1"  
class="td11"> Texas Instruments     </td><td  style="white-space:normal; text-align:left;" id="TBL-5-5-2"  
class="td11"> CC2640R2           </td><td  style="white-space:normal; text-align:left;" id="TBL-5-5-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xticc2640">7</a>]</span> v3.40.00.10                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-6-"><td  style="white-space:normal; text-align:left;" id="TBL-5-6-1"  
class="td11"> Texas Instruments     </td><td  style="white-space:normal; text-align:left;" id="TBL-5-6-2"  
class="td11"> CC2540                </td><td  style="white-space:normal; text-align:left;" id="TBL-5-6-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xticc2540">6</a>]</span> v1.5.1                                      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-7-"><td  style="white-space:normal; text-align:left;" id="TBL-5-7-1"  
class="td11"> Telink                        </td><td  style="white-space:normal; text-align:left;" id="TBL-5-7-2"  
class="td11"> TLSR8258           </td><td  style="white-space:normal; text-align:left;" id="TBL-5-7-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xtelink8258">16</a>]</span> v3.4.0 (SMP fix)                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-8-"><td  style="white-space:normal; text-align:left;" id="TBL-5-8-1"  
class="td11"> Telink                        </td><td  style="white-space:normal; text-align:left;" id="TBL-5-8-2"  
class="td11"> TLSR8232           </td><td  style="white-space:normal; text-align:left;" id="TBL-5-8-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xtelink8232">18</a>]</span> v1.3.0 (SMP fix)                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-9-"><td  style="white-space:normal; text-align:left;" id="TBL-5-9-1"  
class="td11"> Telink                        </td><td  style="white-space:normal; text-align:left;" id="TBL-5-9-2"  
class="td11"> TLSR826x           </td><td  style="white-space:normal; text-align:left;" id="TBL-5-9-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xtelink826x">17</a>]</span> v3.3 (SMP fix)                      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-10-"><td  style="white-space:normal; text-align:left;" id="TBL-5-10-1"  
class="td11"> Dialog                       </td><td  style="white-space:normal; text-align:left;" id="TBL-5-10-2"  
class="td11"> DA1469X            </td><td  style="white-space:normal; text-align:left;" id="TBL-5-10-3"  
class="td11"> <span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xda1469x">9</a>]</span> 10.0.8.105                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-11-"><td  style="white-space:normal; text-align:left;" id="TBL-5-11-1"  
class="td11"> Dialog                       </td><td  style="white-space:normal; text-align:left;" id="TBL-5-11-2"  
class="td11"> DA14585/6          </td><td  style="white-space:normal; text-align:left;" id="TBL-5-11-3"  
class="td11"> <span 
class="ptmb8t-"><p style="color: #CB0000">Unpatched</p> </span>(End March 2020)      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-12-"><td  style="white-space:normal; text-align:left;" id="TBL-5-12-1"  
class="td11"> Dialog                       </td><td  style="white-space:normal; text-align:left;" id="TBL-5-12-2"  
class="td11"> DA14680             </td><td  style="white-space:normal; text-align:left;" id="TBL-5-12-3"  
class="td11"> <span 
class="ptmb8t-"><p style="color: #CB0000">Unpatched</p> </span>(End February 2020)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-13-"><td  style="white-space:normal; text-align:left;" id="TBL-5-13-1"  
class="td11"> Dialog                       </td><td  style="white-space:normal; text-align:left;" id="TBL-5-13-2"  
class="td11"> DA14580             </td><td  style="white-space:normal; text-align:left;" id="TBL-5-13-3"  
class="td11"> <span 
class="ptmb8t-"><p style="color: #CB0000">Unpatched</p> </span>(End March 2020)      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-14-"><td  style="white-space:normal; text-align:left;" id="TBL-5-14-1"  
class="td11"> Microchip                  </td><td  style="white-space:normal; text-align:left;" id="TBL-5-14-2"  
class="td11"> ATSAMB11         </td><td  style="white-space:normal; text-align:left;" id="TBL-5-14-3"  
class="td11"> <span 
class="ptmb8t-"><p style="color: #CB0000">Unpatched</p></span>                                     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-15-"><td  style="white-space:normal; text-align:left;" id="TBL-5-15-1"  
class="td11"> STMicroelectronics  </td><td  style="white-space:normal; text-align:left;" id="TBL-5-15-2"  
class="td11"> WB55                  </td><td  style="white-space:normal; text-align:left;" id="TBL-5-15-3"  
class="td11"> <span 
class="ptmb8t-"><p style="color: #CB0000">Unpatched</p></span>                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-16-"><td  style="white-space:normal; text-align:left;" id="TBL-5-16-1"  
class="td11"> STMicroelectroncis  </td><td  style="white-space:normal; text-align:left;" id="TBL-5-16-2"  
class="td11"> BlueNRG-2          </td><td  style="white-space:normal; text-align:left;" id="TBL-5-16-3"  
class="td11"> <span 
class="ptmb8t-"><p style="color: #CB0000">Unpatched</p></span>                                     </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-17-"><td  style="white-space:normal; text-align:left;" id="TBL-5-17-1"  
class="td11">                  </td></tr></table>                                                </div>
                                                
                                                                                                
                                                                                                
  </div>
  </div>
  <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">4    </span> <a 
 id="x1-70004"></a>Non-compliance in the wild!</h3>
<!--l. 386--><p class="noindent" >In recent years, Bluetooth design has been under scrutiny due to
several security flaws such as KNOB&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xantonioli2019knob">1</a>]</span>, BlueBorne&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xseri2017blueborne">10</a>]</span> and
Invalid ECC Attack&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbiham2019breaking">2</a>]</span>. In contrast, little to no research has
been carried out on the security of the diverse Bluetooth
implementations out in the wild. The current practice is to leave
the implementation tests to the Bluetooth certification process.
This is with the mindset that once the design is sound, hardly
anything can break in the implementation of the Bluetooth
stack.
</p><!--l. 394--><p class="indent" >  Our findings expose some fundamental attack vectors against
certified and recertified BLE Stacks which are supposed to be
&#8220;safe" against such flaws. We carefully investigated the reasons
that might explain the presence of <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span> </span>vulnerabilities
on the affected SoCs. We believe this is due to the imposed
isolation between the link layer and other Bluetooth protocols,
via the Host Controller Interface (HCI) protocol<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth2016bluetooth">12</a>]</span>. While
such a strategy is reasonable for hardware compatibility, this
adds complexity to the implementation. Moreover, it overly
complicates the strategies to systematically and comprehensively
test Bluetooth protocols. Specifically, during testing, it is
complex to send arbitrary Link Layer messages during other
protocol message exchanges. Such added complexity is likely
the reason for inadequate security testing of BLE stack
implementation.
</p><!--l. 406--><p class="indent" >  We carefully read and investigated relevant parts of the
Controller and Host volume of the Core Specification, which
allow us to understand the main interaction of two devices (c.f.,
Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-1001r1">1<!--tex4ht:ref: fig:blesequence --></a>). A natural question that arises for anyone looking a
sequence diagram of the overall pairing procedure is &#8220;<span 
class="ptmri8t-">what</span>
<span 
class="ptmri8t-">happens if the LL encryption starts in the middle of the</span>
<span 
class="ptmri8t-">pairing procedure?</span>". It can be argued that the Zero LTK
installation, Key size overflow and Public Key Crash flaws were
facilitated due to this question not being answered on the
Core Specification itself, leaving it for vendors to decide
how to handle such situation. When attempting to answer
this question, we have received highly different behaviours
across most SoCs we have tested. In addition, several other
implementation details, which are explicitly imposed by the Core
Specification&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth2019bluetooth">13</a>]</span>, are also not followed by SoC vendors in
reality.
</p><!--l. 419--><p class="indent" >  It is worthwhile to mention that every SoC BLE SDK goes
through the certification process before going into market. Thus,
our findings expose that improvements should be made on the
certification process to avoid at least <span 
class="ptmri8t-">simple </span>deviations such as
the LLID deadlock: <span 
class="ptmri8t-">It takes exactly one field to be zero to lead</span>
<span 
class="ptmri8t-">the device into a deadlock</span>. Furthermore, devices from Telink
responds to version requests multiple times, going against <span 
class="ptmb8t-">[Vol 6]</span>
<span 
class="ptmb8t-">Part B, Section 5.1.5 </span>of Core Specification&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth2019bluetooth">13</a>]</span>, which         defines that the peripheral should only respond a version
     request a single time during the same central-peripheral
     connection. Similarly, all devices we have tested accept a
     connection request with the&#8220;hopIncrement" field value of
     less than five. This behaviour goes against <span 
class="ptmb8t-">[Vol 6] Part B,</span>
     <span 
class="ptmb8t-">Section 2.3.3.1</span>, which dictates the valid range of such field to
     be within 5-16. Moreover, all the vulnerabilities we have
     discovered go against <span 
class="ptmb8t-">[Vol 1] Part E, Section 2.7 </span>(Responding to
     malformed behaviour). This part of the specification provides
     directives and few examples to handle invalid or malformed
     packets.
     </p><!--l. 434--><p class="indent" >    In conclusion, we strongly believe that the Bluetooth SIG
     should improve and significantly expand Section&#x00A0;2.7 (the section
     is less than one page!!!) and add more basic tests to the Bluetooth
     certification to avoid zero-day vulnerabilities such as the ones
     captured by <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h</span></span>.
     </p><!--l. 444--><p class="noindent" >
     </p>
         <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">5    </span> <a 
 id="x1-80005"></a>Why we named <span 
class="ptmrc8t-">S<span 
class="small-caps">w</span><span 
class="small-caps">e</span><span 
class="small-caps">y</span><span 
class="small-caps">n</span>T<span 
class="small-caps">o</span><span 
class="small-caps">o</span><span 
class="small-caps">t</span><span 
class="small-caps">h </span></span>?</h3>
     <!--l. 446--><p class="noindent" >The insight behind the name SweynTooth arrives from Sweyn
     Forkbeard, the son of King Harald Bluetooth (after whom the
     Bluetooth Technology was originally named). Sweyn revolted
     against Harald Bluetooth and this forced King Harald to his
     exile. The exile lead to the death of King Harald shortly. We
     envision that if SweynTooth style vulnerabilities are not
     appropriately handled by BLE vendors, then the technology can
     become a breeding ground for attackers. This may, in turn, lead
     the Bluetooth technology to be obsolete.
     </p><!--l. 448--><p class="indent" >    The SweynTooth logo captures a variation of the original
     Bluetooth logo written in the Runic alphabet. From the Runic
     alphabet, the "S" of Sweyn and "B" of Bluetooth are combined to
     design the logo. Moreover, the "S" in the SweynTooth logo
     visually captures that the arm of "H" is broken in the Bluetooth
     logo.
     </p><!--l. 1--><p class="noindent" >
     </p>
         <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">6    </span> <a 
 id="x1-90006"></a><a id="technical-description">Detailed Description</a></h3>
     <!--l. 4--><p class="noindent" >In this section, we provide a detailed description of each
     vulnerability, the affected system-on-chip (SoC) models and the
     SDKs.
     </p><!--l. 7--><p class="noindent" >
     </p>
         <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.1    </span> <a 
 id="x1-100006.1"></a>Link Layer Length Overflow <br 
class="newline" />(CVE-2019-16336, CVE-2019-17519)</h4>
     <!--l. 10--><p class="noindent" >The <span 
class="ptmri8t-">Link Layer Length Overflow </span>vulnerability was identified in
     <span 
class="ptmri8t-">Cypress PSoC4/6 BLE Component 3.41/2.60 </span>(CVE-2019-16336)
     and <span 
class="ptmri8t-">NXP KW41Z 3.40 </span>SDK (CVE-2019-17519). Both
                                                                                                
                                                                                                
implementations are susceptible to the same vulnerability. Such a
vulnerability allows attackers in radio range to trigger a
buffer overflow by manipulating the <span 
class="ptmri8t-">LL Length Field</span>. The
overflow occurs when the attacker, acting as the central
device, sends a packet to the peripheral, which is padded
to include much more bytes than expected from its type
(opcode). An example is shown in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-10001r4">4<!--tex4ht:ref: fig:anomaly1 --></a>. In this case,
a version request is just five bytes of length, but can be
falsely extended to 247 bytes when <span 
class="ptmri8t-">LL Length field </span>value is
increased. When the underlying BLE stack processed such
a packet, more bytes then the expected are allocated in
memory, which caused instabilities and ultimately crashing the
peripheral.
</p><!--l. 25--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>This vulnerability initially causes denial of service
(DoS). However, due to its characteristic, attackers could reverse
engineer products firmware to possibly leverage remote
execution. A concrete evidence of this risk is exemplified by
the BleedingBit vulnerability&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbleedingbit">5</a>]</span>, which allowed remote
execution on certain Texas Instruments devices by means of
manipulating the same <span 
class="ptmri8t-">LL length </span>field, albeit in a more
constrained context. Specifically, BleedingBit exploited the
central implementation of the SoC during during advertisement
phase.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-10001r4"></a>
                                                
                                                                                                
                                                                                                
<!--l. 38--><p class="noindent" > <img 
src="Figures/anomaly_1.pdf.svg" alt="PIC"  
width="360" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;4: </span><span  
class="content">Link Layer Length Overflow vulnerability</span></div><!--tex4ht:label?: x1-10001r4 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.2    </span> <a 
 id="x1-110006.2"></a>Link Layer LLID deadlock<br 
class="newline" />(CVE-2019-17061, CVE-2019-17060)</h4>
<!--l. 46--><p class="noindent" >This critical, yet simple vulnerability can render Cypress
(CVE-2019-17061) and NXP devices in a <span 
class="ptmri8t-">deadlock </span>state
(CVE-2019-17060). We have discovered that if a <span 
class="ptmri8t-">Cypress</span>
<span 
class="ptmri8t-">PSoC4/6 </span>or <span 
class="ptmri8t-">NXP KW41Z </span>device receives a packet with the <span 
class="ptmri8t-">LLID</span>
<span 
class="ptmri8t-">field </span>cleared, then both devices simply enter in a faulty state.
Specifically, this state prevents the BLE stack from working
correctly in posterior connections. The details of the vulnerability
are shown in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-11001r5">5<!--tex4ht:ref: fig:anomaly2 --></a>. It turns out that this attack confuses the
SDK implementation in a manner that any received packet from
the central is handled improperly or simply ignored. For
example, NXP KW41Z peripheral may send responses
completely out of order to the central. In addition, no hard faults
are triggered in the firmware of the device. This, in turn, prevents
auto recovery by means of simply employing watchdog timer on
the product&#8217;s firmware.
</p><!--l. 58--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>The availability of BLE products is critically impaired,
requiring the user to manually perform a power cycle on
the product to re-establish BLE communication. Further
complication arises, as the peripheral continues to advertise itself
after the attack. This makes it difficult for the user to even notice
the existence of the problem. The availability issue is only
exposed when the user connects to the peripheral, revealing a
never ending connection or pairing process.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-11001r5"></a>
                                                
                                                                                                
                                                                                                
<!--l. 70--><p class="noindent" > <img 
src="Figures/anomaly_2.pdf.svg" alt="PIC"  
width="420" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5: </span><span  
class="content">Link Layer LLID deadlock vulnerability</span></div><!--tex4ht:label?: x1-11001r5 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.3    </span> <a 
 id="x1-120006.3"></a>Truncated L2CAP<br 
class="newline" />(CVE-2019-17517)</h4>
<!--l. 79--><p class="noindent" >The <span 
class="ptmri8t-">Truncated L2CAP </span>vulnerability is present on <span 
class="ptmri8t-">Dialog</span>
<span 
class="ptmri8t-">DA14580 </span>devices running <span 
class="ptmri8t-">SDK 5.0.4 </span>or earlier. The flaw
results due to a lack of checks during processing an L2CAP
packet. If the total length of the packet (i.e. <span 
class="ptmri8t-">LL Length</span>) has a
value lower than <span 
class="ptmri7t-">L2CAP</span><span style="margin-left:0.3em" class="thinspace"></span><span style="margin-left:0.3em" class="thinspace"></span><span 
class="ptmri7t-">Length</span> <span 
class="zptmcmr-">+4 </span>for a valid payload,
then the truncated bytes are copied beyond the underlying
reception buffer. Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-12001r6">6<!--tex4ht:ref: fig:anomaly3 --></a> shows an example of a maximum
transmission unit (MTU). The MTU captures a length request,
which has <span 
class="ptmri8t-">LL Length </span>of seven bytes and <span 
class="ptmri8t-">L2CAP Length </span>of
three bytes. If the peripheral receives a malicious MTU
length request with <span 
class="ptmri8t-">LL Length </span>of five bytes instead, the
L2CAP reception buffer is overflown by two bytes (i.e.
<span 
class="ptmri7t-">L2CAP</span><span style="margin-left:0.3em" class="thinspace"></span><span style="margin-left:0.3em" class="thinspace"></span><span 
class="ptmri7t-">Length</span> <span 
class="zptmcmr-">+4</span><span 
class="zpzccmry-">-</span> <span 
class="ptmri7t-">LL</span><span 
class="ptmri7t-">&#x00A0;Length</span>). Therefore, the attacker can
selectively choose the number of bytes to overflow by sending
the correct L2CAP payload and the malformed <span 
class="ptmri8t-">LL Length</span>
combination to the peripheral.
</p><!--l. 93--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>An attacker in radio range can use this attack to perform
denial of service and crash the device. However, a careful
sequence of packets could be sent by the attacker to force
the peripheral into writing certain contents to peripheral
memory adjacent to the L2CAP reception buffer. In the
worst-case scenario, this attack could be a front door to
perform remote execution on products using <span 
class="ptmri8t-">Dialog DA14580</span>
SoC.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-12001r6"></a>
                                                
                                                                                                
                                                                                                
<!--l. 103--><p class="noindent" > <img 
src="Figures/anomaly_3.pdf.svg" alt="PIC"  
width="420" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;6: </span><span  
class="content">Truncated L2CAP vulnerability</span></div><!--tex4ht:label?: x1-12001r6 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.4    </span> <a 
 id="x1-130006.4"></a>Silent Length Overflow<br 
class="newline" />(CVE-2019-17518)</h4>
<!--l. 111--><p class="noindent" >This attack is similar to Link <span 
class="ptmri8t-">Layer Length Overflow </span>(cf.
Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-100006.1">6.1<!--tex4ht:ref: sec:ll-length-overflow --></a>). In <span 
class="ptmri8t-">Dialog DA14680 </span>devices, it was identified that
the peripheral responded to packets from the central with
unexpectedly large <span 
class="ptmri8t-">LL Length</span>. While this behaviour is not
compliant to BLE Core specifications&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth2016bluetooth">12</a>]</span>, it does not appear
to affect the peripheral at first. Nonetheless, when a certain
packet payload with higher than expected <span 
class="ptmri8t-">LL Length </span>is sent, the
peripheral crashes. This indicates that an overflow on the
reception buffer had occurred for certain packet types such as
pairing request.
</p><!--l. 121--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>An attacker in radio range can mostly use this attack to
perform denial of service and crash the device. Given that a
buffer overflow is being triggered depending on the packet, a
remote execution scenario is a possibility. Furthermore, the SoCs
affected by this vulnerability are known to be used in a
large number of smart home products, which increases
the reachability and risk of a more serious exploit of this
vulnerability.
</p><!--l. 133--><p class="noindent" >
</p>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.5    </span> <a 
 id="x1-140006.5"></a>Invalid Connection Request<br 
class="newline" />(CVE-2019-19195)</h4>
<!--l. 134--><p class="noindent" >We identified that sample applications provided in <span 
class="ptmri8t-">Texas</span>
<span 
class="ptmri8t-">Instruments CC2640R2 BLE-STACK SDK </span>(v3.30.00.20 and
prior) and <span 
class="ptmri8t-">CC2540 SDK </span>(v1.5.0 and prior) do not properly
handle some connection parameters when the central attempts a
connection to the peripheral. Instead, the peripheral creates a
connection with the central, but fails at a later stage and
moves the peripheral state to idle (i.e., stops advertisement).
If the idle state is not handled correctly in the product&#8217;s
code, the device does not go back to the advertisement stage
again.
</p><!--l. 136--><p class="indent" >  During the initial phase of a BLE connection, the central
device scans for advertisements packets from the peripheral and
sends a connection request packet, which contains relevant
parameters such as connection <span 
class="ptmri8t-">interval </span>and <span 
class="ptmri8t-">timeout</span>. These
two parameters control the cadence of packet exchange
and timeout between peripheral and the central device,
respectively. Their values must represent a non-zero time period
in <span 
class="ptmri8t-">milliseconds </span>when multiplied by a factor of <span 
class="ptmb8t-">1.25</span>. However, if
the central device sends an invalid connection request with the
fields <span 
class="ptmri8t-">interval </span>or <span 
class="ptmri8t-">timeout </span>as zero, then the peripheral stops
advertisement. During reception of an invalid connection request,
the BLE stack sends a connection request fail event to the
application code (bleGAPConnNotAcceptable) and upon
receiving this fail status, the sample application enters in          idle state by default, thus stopping advertisements. This
     behaviour is not the flaw alone, as idle state is a common state
     in BLE and should be handled by the application, due to
     other state transitions that can occur during application
     operation.
     </p><!--l. 147--><p class="indent" >    Nevertheless, we have discovered that this state change under
     reception of invalid parameters is not sufficiently documented in
     TI SDK, which may lead product developers to not handle idle
     state. The mishandling of this state can lead products such
     as eGeeLock to stop advertisement and hence requiring
     user intervention. An illustration of this attack is given in
     Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-14001r7">7<!--tex4ht:ref: fig:anomaly4 --></a>.
     </p><!--l. 149--><p class="indent" >    Interestingly, <span 
class="ptmri8t-">CC2540 </span>also accepts connection requests with
     packet length lower than expected (truncated), which triggers the
     same behaviour (i.e., Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-14001r7">7<!--tex4ht:ref: fig:anomaly4 --></a>) due to its implementation
     assuming zero bytes for truncated fields.
     </p><!--l. 154--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>An attacker in radio range can exploit the phenomenon
     observed in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-14001r7">7<!--tex4ht:ref: fig:anomaly4 --></a> to easily perform DoS in products using the
     vulnerable SoCs. Furthermore, if the product vendor does not
     implement mechanisms to detect such a faulty behaviour, the
     device can be driven into a deadlock state. This, in turn, requires
     the user to manually restart the device. In general, the impact on
     such affected products is similar to the <span 
class="ptmri8t-">LLID Deadlock </span>(cf.
     Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-110006.2">6.2<!--tex4ht:ref: sec:llid-deadlock --></a>).
     </p>
         <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-14001r7"></a>
                                                
                                                                                                
                                                                                                
<!--l. 167--><p class="noindent" > <img 
src="Figures/anomaly_4.pdf.svg" alt="PIC"  
width="420" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;7: </span><span  
class="content">Invalid Connection Deadlock</span></div><!--tex4ht:label?: x1-14001r7 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.6    </span> <a 
 id="x1-150006.6"></a>Unexpected Public Key Crash <br 
class="newline" />(CVE-2019-17520)</h4>
<!--l. 174--><p class="noindent" >This vulnerability was found on Texas Instruments <span 
class="ptmri8t-">CC2640R2</span>
BLE-STACK-SDK (v3.30.00.20 and prior versions). Specifically,
the vulnerability is present in the implementation of the legacy
pairing procedure which is handled by the Secure Manager
Protocol (SMP) implementation. When the peripheral performs
the legacy pairing procedure, it is possible to cause a hard fault in
device&#8217;s memory by sending an SMP public key packet before
the SMP pairing procedure starts (Step&#x00A0;9 in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-1001r1">1<!--tex4ht:ref: fig:blesequence --></a>).
Normally, the peripheral should ignore the reception of a
public key if secure connection is not enabled in the <span 
class="ptmri8t-">pairing</span>
<span 
class="ptmri8t-">request/response </span>exchange. During our coordination with the
vendor, Texas Instruments informed us that the hard fault is
triggered because the peripheral accepts the public key and tries
to copy it to a null target address. Normally, this address
corresponds to a valid allocated buffer if secure connection is
properly indicated during the <span 
class="ptmri8t-">pairing request/response </span>process.
We illustrate the vulnerability in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-15001r8">8<!--tex4ht:ref: fig:anomaly8 --></a> (SC means secure
connection).
</p><!--l. 188--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>An attacker in radio range can exploit the aforementioned
behaviour to perform DoS and possibly restart products using the
<span 
class="ptmri8t-">CC2640R2 </span>SoC for the main application. On the bright side, it is
not possible to perform a buffer overflow in the peripheral&#8217;s
memory. This is because the unexpected public key is always
copied to a null address, which is beyond the control of the
attacker. It is worthwhile to mention that this vulnerability can
also lead to a deadlock. This is exemplified by our evaluation on
the <span 
class="ptmri8t-">CubiTag bluetooth tracker</span>. The product CubiTag does not
properly handle hard faults and hence enters a deadlock state.
This requires the user of the tracker to manually restart
it.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-15001r8"></a>
                                                
                                                                                                
                                                                                                
<!--l. 202--><p class="noindent" > <img 
src="Figures/anomaly_8.pdf.svg" alt="PIC"  
width="360" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;8: </span><span  
class="content">Unexpected Public Key Crash</span></div><!--tex4ht:label?: x1-15001r8 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.7    </span> <a 
 id="x1-160006.7"></a>Sequential ATT Deadlock<br 
class="newline" />(CVE-2019-19192)</h4>
<!--l. 211--><p class="noindent" >In <span 
class="ptmri8t-">STMicroelectronics WB55 SDK V1.3.0 </span>and earlier, it is
possible to deadlock the peripheral by sending just two
consecutive ATT request packets in each connection event.
Normally, each ATT request sent from a central device is
followed by an ATT response from the peripheral. This happens
in a time period multiple of the connection interval <span 
class="zptmcmr-">&#x0394;</span><span 
class="zptmcmrm-">t</span>. However,
it is possible that a rogue central device sends multiple and
consecutive ATT requests separated by the connection interval
<span 
class="zptmcmr-">&#x0394;</span><span 
class="zptmcmrm-">t </span>(Figure <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-16001r9">9<!--tex4ht:ref: fig:anomaly5 --></a>). In such a case, the peripheral does not get
sufficient time to respond to the first ATT request. The resulting
behaviour is a fault in the coprocessor that runs the BLE
SDK inside WB55, preventing certain BLE event flags
to be cleared. This leads to a deadlock of the WB55 user
code. Specifically, the faulty code potentially gets stuck
in a <span 
class="pcrr8tn-">while </span>loop, which waits for a never finishing BLE
event.
</p><!--l. 226--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>Similar to several other vulnerabilities discussed in this
work, the exploitation of this vulnerability can leave the product
in a deadlock state if a stability mechanism, such as the watchdog
timer, is not employed by the vendor in product&#8217;s firmware. If
such a mechanism is present, the attack is still guaranteed to
remotely restart the device.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-16001r9"></a>
                                                
                                                                                                
                                                                                                
<!--l. 236--><p class="noindent" > <img 
src="Figures/anomaly_5.pdf.svg" alt="PIC"  
width="360" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;9: </span><span  
class="content">Sequential ATT Deadlock</span></div><!--tex4ht:label?: x1-16001r9 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.8    </span> <a 
 id="x1-170006.8"></a>Invalid L2CAP fragment<br 
class="newline" />(CVE-2019-19195)</h4>
<!--l. 244--><p class="noindent" >During the communication between the central device and
peripheral, the Bluetooth 4.0-4.2 Core specification dictates that
the minimum and maximum PDU size of the packets should be
in the range 2-39&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xversion42">11</a>]</span>. Packets outside this boundary should
be discarded as they are invalid. However, we discovered
that such is not the case for devices running <span 
class="ptmri8t-">Microchip</span>
<span 
class="ptmri8t-">ATMSAMB11 BluSDK Smart v6.2 </span>and earlier. Following
Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-17001r10">10<!--tex4ht:ref: fig:anomaly9 --></a>, it was discovered that if an L2CAP PDU of
length one is sent to the peripheral, then the device simply
crashes.
</p><!--l. 254--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>The watchdog mechanism is enabled by default in the
SDK, which reduces the risk for products relying on <span 
class="ptmri8t-">ATSAMB11</span>
BLE solution to exhibit deadlock behaviour. Therefore, this
vulnerability mostly affects the availability of the device by
remotely restarting them.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-17001r10"></a>
                                                
                                                                                                
                                                                                                
<!--l. 264--><p class="noindent" > <img 
src="Figures/anomaly_9.pdf.svg" alt="PIC"  
width="360" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;10: </span><span  
class="content">Invalid L2CAP fragment</span></div><!--tex4ht:label?: x1-17001r10 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.9    </span> <a 
 id="x1-180006.9"></a>Key Size Overflow<br 
class="newline" />(CVE-2019-19196)</h4>
<!--l. 273--><p class="noindent" >The Key Size Overflow vulnerability was found in all <span 
class="ptmri8t-">Telink</span>
<span 
class="ptmri8t-">Semiconductor </span>BLE SDKs. This causes an overflow in the device
memory, resulting in a crash. However, the problem that allows
this vulnerability is a combination of multiple issue found
during the pairing procedure of devices using Telink SMP
implementation.
</p><!--l. 279--><p class="indent" >  During the start of the pairing procedure, the central device
sends a <span 
class="ptmri8t-">Pairing request </span>packet containing the maximum allowed
key size to be negotiated at the end of the pairing procedure.
The maximum key size is standardised to be within 7 to
16 bytes and any deviation from that should be rejected
with a <span 
class="ptmri8t-">pairing failure </span>response. However, Telink peripheral
actually accepts a <span 
class="ptmri8t-">maximum encryption key size </span>up to 255
by answering the central device with a <span 
class="ptmri8t-">paring response</span>
instead. Despite this first problem, the peripheral rejects the
pairing during at later exchanges of the pairing procedure
without abnormal behaviour. The second and final problem
that finally triggers the vulnerability, arises because the
peripheral accepts the <span 
class="ptmri8t-">LL Encryption procedure </span>to occur
before the pairing procedure even starts, albeit failing at later
stage.
</p><!--l. 295--><p class="indent" >  By combining the two mentioned problems it is possible to
force the peripheral into allocating the over sized key buffer
length which was negotiated during the <span 
class="ptmri8t-">pairing request</span>. Depicted
in Figure <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-18001r11">11<!--tex4ht:ref: fig:anomaly6 --></a>, the central device sends the invalid <span 
class="ptmri8t-">pairing request</span>,
waits for <span 
class="ptmri8t-">pairing response </span>and sends an <span 
class="ptmri8t-">encryption request</span>.
The request is accepted and a buffer overflow occurs in
peripheral&#8217;s memory as its firmware tries to allocate the
oversized key.
</p><!--l. 303--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>This vulnerability allows an attacker in radio to
perform buffer overflow and crash Telink SoCs products
with pairing support enabled, which is a common practice
in several BLE products. While this vulnerability doesn&#8217;t
expose easy control over the overflown buffer, an exploit
could be carefully constructed to overwrite memory contents
adjacent to the key buffer if the the memory layout of the
product&#8217;s firmware is known. In the worst case, it could be
possible to overwrite buffers that store encryption nonce
would allow the attacker to bypass encryption and leak user
information.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-18001r11"></a>
                                                
                                                                                                
                                                                                                
<!--l. 311--><p class="noindent" > <img 
src="Figures/anomaly_6.pdf.svg" alt="PIC"  
width="420" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;11: </span><span  
class="content">Key Size Overflow</span></div><!--tex4ht:label?: x1-18001r11 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">6.10    </span> <a 
 id="x1-190006.10"></a>Zero LTK Installation<br 
class="newline" />(CVE-2019-19194)</h4>
<!--l. 320--><p class="noindent" >This critical vulnerability is a variation of one of the Key
Size Overflow. It affects all products using Telink SMP
implementation with support for secure connection enabled. It
was verified that when the Telink peripheral accepts an out of
order encryption request from the central, the encryption
procedure is successful with a LTK which is zero. The LTK size,
usually of 16 bytes, is agreed during the <span 
class="ptmri8t-">pairing request/response</span>
exchange.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-19001r12"></a>
                                                
                                                                                                
                                                                                                
<!--l. 325--><p class="noindent" > <img 
src="Figures/anomaly_7.pdf.svg" alt="PIC"  
width="360" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;12: </span><span  
class="content">Zero LTK Installation</span></div><!--tex4ht:label?: x1-19001r12 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 332--><p class="indent" >  Following Figure <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-17001r10">10<!--tex4ht:ref: fig:anomaly9 --></a>, the rogue central sends a <span 
class="ptmri8t-">pairing</span>
<span 
class="ptmri8t-">request </span>with secure connections pairing indicated and waits
for a <span 
class="ptmri8t-">pairing response</span>. Next, the central skips the secure
connections pairing procedure and starts the encryption
procedure by sending a <span 
class="ptmri8t-">encryption request</span>. Due to the lack
of validation in peripheral&#8217;s implementation, the central
receives a <span 
class="ptmri8t-">encryption start </span>from the peripheral and sends
an encrypted <span 
class="ptmri8t-">encryption response </span>back. This response is
relevant because the peripheral validates it against the session
key <span 
class="zptmcmrm-">SK</span>, which is derived from a valid LTK. Interestingly,
the peripheral&#8217;s LTK is initialized as zero. This allows the
central to easily derive the <span 
class="zptmcmrm-">SK </span>to send the correct encrypted
<span 
class="ptmri8t-">encryption response </span>to the peripheral, hence successfully
completing the encryption procedure. The <span 
class="zptmcmrm-">SK </span>(hiddenly
mentioned in Bluetooth Core Specification as <span 
class="ptmri8t-">sessionKey</span><span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xbluetooth2016bluetooth">12</a>]</span>)
is generated by the cryptographic function of Equation
<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-19002r1">1<!--tex4ht:ref: eq:1 --></a>.
</p>
  <table 
class="equation"><tr><td><a 
 id="x1-19002r1"></a>
  <center class="math-display" >
<img 
src="disclosure0x.svg" alt="SK = AESECB(Key= LTK,Plaintext = SKD )
" class="math-display"  /></center></td><td class="equation-label">(1)</td></tr></table>
<!--l. 337--><p class="nopar" >
</p><!--l. 339--><p class="indent" >  The Session Key Diversifier (<span 
class="zptmcmrm-">SKD</span>) is a random 16 byte
number obtained via the <span 
class="ptmri8t-">encryption request/response </span>exchange,
therefore, guessing the correct LTK allows the central device to
send a encrypted <span 
class="ptmri8t-">encryption response </span>with a valid <span 
class="zptmcmrm-">SK</span>. As an
aggravating factor, the <span 
class="ptmri8t-">Keys distribution procedure </span>is completely
bypassed after the attack is performed.
</p><!--l. 341--><p class="noindent" ><span 
class="ptmb8t-"><q-chip style="width: 100px" square color="deep-orange" text-color="white" icon="warning">Impact</q-chip> </span>An attacker in Radio range can abuse this vulnerability
to completely bypass security in a BLE products which rely in
secure connections pairing to protect user privacy. Furthermore,
device&#8217;s functionalities which were only allowed to be accessed
by an authorized user, can be trivially bypassed. In short, this
vulnerability allows an attacker full communication control over
a protected BLE application.
</p><!--l. 345--><p class="indent" >  As a side note, this vulnerability only affects Telink devices
that allows secure connection pairing. In reality, affected
products that disable secure connections pairing (the currently
secure BLE pairing mode) and enable only the insecure
legacy pairing mode, are in fact more secure due to this
vulnerability.                                           </p>
         <h3 class="likesectionHead"><a 
 id="x1-200006.10"></a>Acknowledgements</h3>
     <!--l. 458--><p class="noindent" >This research was partially supported by <a 
href="https://www.keysight.com/sg/en/home.html" >Keysight Technologies</a>.
     We also want to thank all the involved vendors for their fast
     responses and support during the coordination process.
     </p><!--l. 466--><p class="noindent" >
     </p>
     <h3 class="likesectionHead"><a 
 id="x1-210006.10"></a>References</h3>
     <!--l. 1--><p class="noindent" >
             </p><div class="thebibliography">
             <p class="bibitem" ><span class="biblabel">
         [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
             <a 
 id="Xantonioli2019knob"></a>Daniele
             Antonioli,
             Nils&#x00A0;Ole
             Tippenhauer,
             and
             Kasper&#x00A0;B.
             Rasmussen.
             The
             KNOB
             is
             broken:
             Exploiting
             low
             entropy
             in
             the
             encryption
             key
             negotiation
             of
             Bluetooth
             BR/EDR.
             In
             <span 
class="ptmri8t-">28th</span>
             <span 
class="ptmri8t-">USENIX</span>
             <span 
class="ptmri8t-">Security</span>
             <span 
class="ptmri8t-">Symposium</span>
             <span 
class="ptmri8t-">(USENIX</span>
             <span 
class="ptmri8t-">Security</span>
             <span 
class="ptmri8t-">19)</span>,
             pages
             1047&#8211;1061,
             Santa
             Clara,
             CA,
             August
             2019.
                                                                                                
                                                                                                
    USENIX
    Association.
    </p>
    <p class="bibitem" ><span class="biblabel">
  [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
    <a 
 id="Xbiham2019breaking"></a>Eli
    Biham
    and
    Lior
    Neumann.
    Breaking
    the
    bluetooth
    pairing&#8211;the
    fixed
    coordinate
    invalid
    curve
    attack.
    In
    <span 
class="ptmri8t-">International</span>
    <span 
class="ptmri8t-">Conference</span>
    <span 
class="ptmri8t-">on</span>
    <span 
class="ptmri8t-">Selected</span>
    <span 
class="ptmri8t-">Areas</span>
    <span 
class="ptmri8t-">in</span>
    <span 
class="ptmri8t-">Cryptography</span>,
    pages
    250&#8211;273.
    Springer,
    2019.
    </p>
    <p class="bibitem" ><span class="biblabel">
  [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
    <a 
 id="Xpsoc4sdk"></a>Cypress.
    Component
    Datasheet
    -
    Bluetooth
    Low
    Energy
    (BLE),
    February
    2020.
    <a 
href="https://www.cypress.com/documentation/component-datasheets/psoc-creator-component-datasheet-bluetooth-low-energy-ble" target="_blank" class="url" >https://www.cypress.com/documentation/component-datasheets/psoc-creator-component-datasheet-bluetooth-low-energy-ble</a>.
    </p>
    <p class="bibitem" ><span class="biblabel">
  [4]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>                                                      <a 
 id="Xpsoc6sdk"></a>Cypress.
             Component
             Datasheet
             -
             Bluetooth
             Low
             Energy
             (BLE_PDL),
             February
             2020.
             <a 
href="https://www.cypress.com/documentation/component-datasheets/bluetooth-low-energy-blepdl" target="_blank" class="url" >https://www.cypress.com/documentation/component-datasheets/bluetooth-low-energy-blepdl</a>.
             </p>
             <p class="bibitem" ><span class="biblabel">
         [5]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
             <a 
 id="Xbleedingbit"></a>Armis
             Inc.
             Bleedingbit
             vulnerability.
             <a 
href="https://armis.com/bleedingbit/" target="_blank" class="url" >https://armis.com/bleedingbit/</a>,
             2018.
             </p>
             <p class="bibitem" ><span class="biblabel">
         [6]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
             <a 
 id="Xticc2540"></a>Texas
             Instruments.
             Bluetooth
             low
             energy
             software
             stack,
             February
             2020.
             <a 
href="http://www.ti.com/tool/BLE-STACK" target="_blank" class="url" >http://www.ti.com/tool/BLE-STACK</a>.
             </p>
             <p class="bibitem" ><span class="biblabel">
         [7]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
             <a 
 id="Xticc2640"></a>Texas
             Instruments.
             SimpleLink
             CC2640R2
             SDK
             -
             Bluetooth
             Low
             Energy,
             February
             2020.
             <a 
href="http://www.ti.com/tool/SIMPLELINK-CC2640R2-SDK" target="_blank" class="url" >http://www.ti.com/tool/SIMPLELINK-CC2640R2-SDK</a>.
                                                                                                
                                                                                                
    </p>
    <p class="bibitem" ><span class="biblabel">
  [8]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
    <a 
 id="Xnxpsdk"></a>NXP.
    MCUXpresso
    Software
    Development
    Kit
    (SDK),
    January
    2020.
    <a 
href="https://www.nxp.com/design/software/development-software/mcuxpresso-software-and-tools/mcuxpresso-software-development-kit-sdk:MCUXpresso-SDK?tab=Design_Tools_Tab" target="_blank" class="url" >https://www.nxp.com/design/software/development-software/mcuxpresso-software-and-tools/mcuxpresso-software-development-kit-sdk:MCUXpresso-SDK?tab=Design_Tools_Tab</a>.
    </p>
    <p class="bibitem" ><span class="biblabel">
  [9]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
    <a 
 id="Xda1469x"></a>Dialog
    Semiconductor.
    SmartBond
    DA1469x
    Product
    Family,
    February
    2020.
    <a 
href="https://support.dialog-semiconductor.com/system/files/restricted/SDK_10.0.8.105.zip" target="_blank" class="url" >https://support.dialog-semiconductor.com/system/files/restricted/SDK_10.0.8.105.zip</a>.
    </p>
    <p class="bibitem" ><span class="biblabel">
 [10]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
    <a 
 id="Xseri2017blueborne"></a>Ben
    Seri
    and
    Gregory
    Vishnepolsky.
    Blueborne.
    Armis.
    <a 
href="https://www.armis.com/blueborne/" target="_blank" class="url" >https://www.armis.com/blueborne/</a>,
    2017.
    </p>
    <p class="bibitem" ><span class="biblabel">
 [11]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
    <a 
 id="Xversion42"></a>Bluetooth
    SIG.
    Bluetooth
    Core
    Specification
    v4.2,
    December                                                 2014.
             <a 
href="https://www.bluetooth.com/specifications/bluetooth-core-specification" target="_blank" class="url" >https://www.bluetooth.com/specifications/bluetooth-core-specification</a>.
             </p>
             <p class="bibitem" ><span class="biblabel">
       [12]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
             <a 
 id="Xbluetooth2016bluetooth"></a>Bluetooth
             SIG.
             Bluetooth
             Core
             Specification
             v5.0,
             December
             2016.
             <a 
href="https://www.bluetooth.com/specifications/bluetooth-core-specification" target="_blank" class="url" >https://www.bluetooth.com/specifications/bluetooth-core-specification</a>.
             </p>
             <p class="bibitem" ><span class="biblabel">
       [13]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
             <a 
 id="Xbluetooth2019bluetooth"></a>Bluetooth
             SIG.
             Bluetooth
             Core
             Specification
             v5.1,
             January
             2019.
             <a 
href="https://www.bluetooth.com/specifications/bluetooth-core-specification" target="_blank" class="url" >https://www.bluetooth.com/specifications/bluetooth-core-specification</a>.
             </p>
             <p class="bibitem" ><span class="biblabel">
       [14]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
             <a 
 id="Xbluetooth-listing"></a>Bluetooth
             SIG.
             View
             previously
             qualified
             designs
             and
             declared
             products,
             January
             2020.
             <a 
href="https://launchstudio.bluetooth.com/Listings/Search" target="_blank" class="url" >https://launchstudio.bluetooth.com/Listings/Search</a>.
             </p>
             <p class="bibitem" ><span class="biblabel">
       [15]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
             <a 
 id="Xswipbox"></a>Swipbox.
             Swipbox
                                                                                                
                                                                                                
    Infinity
    Product
    page,
    January
    2019.
    <a 
href="https://www.swipbox.com/products_infinity.html" target="_blank" class="url" >https://www.swipbox.com/products_infinity.html</a>.
    </p>
    <p class="bibitem" ><span class="biblabel">
 [16]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
    <a 
 id="Xtelink8258"></a>Telink.
    Telink
    wiki
    -
    Kite
    BLE
    SDK
    V3.4.0,
    February
    2020.
    <a 
href="http://wiki.telink-semi.cn/tools\_and\_sdk/BLE_SDK/8x5x_SDK/ble_sdk.zip" target="_blank" class="url" >http://wiki.telink-semi.cn/tools\_and\_sdk/BLE_SDK/8x5x_SDK/ble_sdk.zip</a>.
    </p>
    <p class="bibitem" ><span class="biblabel">
 [17]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
    <a 
 id="Xtelink826x"></a>Telink.                                             Telink
                                                       wiki
                                                       826x
                                                       Ble
                                                       SDK
                                                       v3.3,
                                                       February
                                                       2020.
                                                       <a 
href="http://wiki.telink-semi.cn/tools_and_sdk/BLE_SDK/826x_SDK/ble_sdk.rar" target="_blank" class="url" >http://wiki.telink-semi.cn/tools_and_sdk/BLE_SDK/826x_SDK/ble_sdk.rar</a>.
                                                       </p>
                                                       <p class="bibitem" ><span class="biblabel">
                                                   [18]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
                                                       <a 
 id="Xtelink8232"></a>Telink.
                                                       Telink
                                                       wiki
                                                       TLSR8232
                                                       SDK
                                                       V1.3.0,
                                                       February
                                                       2020.
                                                       <a 
href="http://wiki.telink-semi.cn/tools_and_sdk/BLE_SDK/823x_SDK/ble_sdk.zip" target="_blank" class="url" >http://wiki.telink-semi.cn/tools_and_sdk/BLE_SDK/823x_SDK/ble_sdk.zip</a>.
                                                  </p>
                                                       </div>
                                                   
</div>
<script>new Vue({el: "#q-app",data: function () {return {}},methods: {},beforeMount() {}})</script>
</body></html> 

                                                                                                


                                                  <a 
href="http://w


